{"version":3,"file":"query.js","sourceRoot":"","sources":["../../src/lib/query.ts"],"names":[],"mappings":"AAAA,OAAO,MAAM,MAAM,yBAAyB,CAAC;AAE7C,MAAM,CAAC,KAAK,UAAU,eAAe;IACjC,MAAM,GAAG,GAAG;;;;;;;;;;;;;;;;;;;;KAoBX,CAAC;IACF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,OAAO,CAAC,GAAG,CAAC,0BAA0B,EAAE,IAAI,CAAC,CAAC;IAC9C,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,iBAAiB;IACnC,MAAM,GAAG,GAAG;;;;;KAKX,CAAC;IAEF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,OAAO,CAAC,GAAG,CAAC,4BAA4B,EAAE,IAAI,CAAC,CAAC;IAEhD,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,WAAW;IAC7B,MAAM,GAAG,GAAG;;;;;;;KAOX,CAAC;IAEF,MAAM,EAAE,IAAI,EAAE,GAAG,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACzC,OAAO,IAAI,CAAC;AAChB,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,cAAc,CAAC,UAAkB,EAAE,SAAiB,EAAE,OAAe,EAAE,UAAyB;IAClH,MAAM,GAAG,GAAG;;;KAGX,CAAC;IAEF,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,OAAO,EAAE,UAAU,CAAC,CAAC,CAAC;IACtE,OAAO,CAAC,GAAG,CAAC,qBAAqB,UAAU,IAAI,SAAS,EAAE,CAAC,CAAC;AAChE,CAAC;AACD,MAAM,CAAC,KAAK,UAAU,UAAU,CAAC,KAAa,EAAE,MAAc,EAAE,aAAqB;IACjF,MAAM,GAAG,GAAG;;;KAGX,CAAC;IAEF,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,KAAK,EAAE,MAAM,EAAE,aAAa,CAAC,CAAC,CAAC;IACxD,OAAO,CAAC,GAAG,CAAC,iBAAiB,KAAK,sBAAsB,aAAa,EAAE,CAAC,CAAC;AAC7E,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,gBAAgB,CAAC,IAAY;IAC/C,MAAM,GAAG,GAAG;;;KAGX,CAAC;IAEF,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,IAAI,CAAC,CAAC,CAAC;IAChC,OAAO,CAAC,GAAG,CAAC,uBAAuB,IAAI,EAAE,CAAC,CAAC;AAC/C,CAAC;AAED,MAAM,CAAC,KAAK,UAAU,sBAAsB,CAAC,WAAmB,EAAE,WAAmB;IACjF,MAAM,GAAG,GAAG;;;;KAIX,CAAC;IAEF,MAAM,MAAM,CAAC,KAAK,CAAC,GAAG,EAAE,CAAC,WAAW,EAAE,WAAW,CAAC,CAAC,CAAC;IACpD,OAAO,CAAC,GAAG,CAAC,yBAAyB,WAAW,sBAAsB,WAAW,GAAG,CAAC,CAAC;AAC1F,CAAC","sourcesContent":["import client from '../config/connection.js';\r\n\r\nexport async function getAllEmployees() {\r\n    const sql = `\r\n\r\nSELECT \r\n    employee.id AS employee_id,\r\n    employee.first_name,  \r\n    employee.last_name,\r\n    role.id AS role_id,\r\n    role.title AS role_title,\r\n    role.salary AS role_salary,\r\n    department.id AS department_id,\r\n    department.name AS department_name,\r\n    CONCAT(manager.first_name, ' ', manager.last_name) AS manager_name\r\nFROM employee\r\nJOIN role\r\n    ON employee.role_id = role.id\r\nJOIN department\r\n    ON role.department_id = department.id\r\nLEFT JOIN employee AS manager\r\n    ON employee.manager_id = manager.id;\r\n\r\n    `;\r\n    const { rows } = await client.query(sql);\r\n    console.log('Retrieved employee rows:', rows);\r\n    return rows;\r\n}\r\n\r\nexport async function getAllDepartments() {\r\n    const sql = `\r\n    SELECT \r\n        id,\r\n        name\r\n    FROM department;\r\n    `;\r\n\r\n    const { rows } = await client.query(sql);\r\n    console.log('Retrieved department rows:', rows);\r\n\r\n    return rows;\r\n}\r\n\r\nexport async function getAllRoles() {\r\n    const sql = `\r\n    SELECT \r\n        id,\r\n        title,\r\n        salary,\r\n        department_id\r\n    FROM role;\r\n    `;\r\n\r\n    const { rows } = await client.query(sql);\r\n    return rows;\r\n}\r\n\r\nexport async function createEmployee(first_name: string, last_name: string, role_id: number, manager_id: number | null) {\r\n    const sql = `\r\n    INSERT INTO employee (first_name, last_name, role_id, manager_id)\r\n    VALUES ($1, $2, $3, $4);\r\n    `;\r\n\r\n    await client.query(sql, [first_name, last_name, role_id, manager_id]);\r\n    console.log(`Created employee: ${first_name} ${last_name}`);\r\n}\r\nexport async function createRole(title: string, salary: number, department_id: number) {\r\n    const sql = `\r\n    INSERT INTO role (title, salary, department_id)\r\n    VALUES ($1, $2, $3);\r\n    `;\r\n\r\n    await client.query(sql, [title, salary, department_id]);\r\n    console.log(`Role created: ${title} in department ID: ${department_id}`);\r\n}\r\n\r\nexport async function createDepartment(name: string) {\r\n    const sql = `\r\n    INSERT INTO department (name)\r\n    VALUES ($1);\r\n    `;\r\n\r\n    await client.query(sql, [name]);\r\n    console.log(`Department created: ${name}`);\r\n}\r\n\r\nexport async function updateEmployeeRoleInDB(employee_id: number, new_role_id: number) {\r\n    const sql = `\r\n    UPDATE employee\r\n    SET role_id = $1\r\n    WHERE id = $2;\r\n    `;\r\n\r\n    await client.query(sql, [new_role_id, employee_id]);\r\n    console.log(`Updated employee (ID: ${employee_id}) to new role (ID: ${new_role_id})`);\r\n}"]}